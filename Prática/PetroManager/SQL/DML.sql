

INSERT INTO PM.Funcionario (ID, Nome, Salario, Contacto, Email, ID_Posto) VALUES
(001, 'Joao Silva', 1500.00, 912345678, 'joao.silva@PetroManager.com', 001),
(002, 'Ana Santos', 1600.00, 923456789, 'ana.santos@PetroManager.com', 001),
(003, 'Pedro Costa', 1550.00, 934567890, 'pedro.costa@PetroManager.com', 001),
(004, 'Marta Ferreira', 1700.00, 945678901, 'marta.ferreira@PetroManager.com', 001),
(005, 'Carlos Sousa', 1600.00, 956789012, 'carlos.sousa@PetroManager.com', 001),
(006, 'Sofia Oliveira', 1550.00, 912345678, 'sofia.oliveira@PetroManager.com', 002),
(007, 'Rui Pereira', 1650.00, 923456789, 'rui.pereira@PetroManager.com', 002),
(008, 'Ines Almeida', 1700.00, 934567890, 'ines.almeida@PetroManager.com', 002),
(009, 'Hugo Martins', 1600.00, 945678901, 'hugo.martins@PetroManager.com', 002),
(010, 'Lucia Fernandes', 1600.00, 956789012, 'lucia.fernandes@PetroManager.com', 002),
(011, 'Daniel Santos', 1600.00, 912345678, 'daniel.santos@PetroManager.com', 003),
(012, 'Mariana Lima', 1700.00, 923456789, 'mariana.lima@PetroManager.com', 003),
(013, 'Tiago Sousa', 1550.00, 934567890, 'tiago.sousa@PetroManager.com', 003),
(014, 'Ana Rita', 1600.00, 945678901, 'ana.rita@PetroManager.com', 003),
(015, 'Jose Carvalho', 1650.00, 956789012, 'jose.carvalho@PetroManager.com', 003),
(016, 'Catarina Goncalves', 1600.00, 912345678, 'catarina.goncalves@PetroManager.com', 004),
(017, 'Paulo Rodrigues', 1550.00, 923456789, 'paulo.rodrigues@PetroManager.com', 004),
(018, 'Ines Costa', 1700.00, 934567890, 'ines.costa@PetroManager.com', 004),
(019, 'Miguel Pereira', 1600.00, 945678901, 'miguel.pereira@PetroManager.com', 004),
(020, 'Carolina Alves', 1600.00, 956789012, 'carolina.alves@PetroManager.com', 004),
(021, 'Vasco Ferreira', 1600.00, 912345678, 'vasco.ferreira@PetroManager.com', 005),
(022, 'Sara Martins', 1650.00, 923456789, 'sara.martins@PetroManager.com', 005),
(023, 'Ricardo Oliveira', 1600.00, 934567890, 'ricardo.oliveira@PetroManager.com', 005),
(024, 'Diana Silva', 1550.00, 945678901, 'diana.silva@PetroManager.com', 005),
(025, 'Luis Santos', 1700.00, 956789012, 'luis.santos@PetroManager.com', 005),
(026, 'Andreia Santos', 1600.00, 912345678, 'andreia.santos@PetroManager.com', 006),
(027, 'Bruno Oliveira', 1550.00, 923456789, 'bruno.oliveira@PetroManager.com', 006),
(028, 'Monica Silva', 1700.00, 934567890, 'monica.silva@PetroManager.com', 006),
(029, 'Nuno Pereira', 1600.00, 945678901, 'nuno.pereira@PetroManager.com', 006),
(030, 'Carla Fernandes', 1600.00, 956789012, 'carla.fernandes@PetroManager.com', 006),
(031, 'Helder Costa', 1600.00, 912345678, 'helder.costa@PetroManager.com', 007),
(032, 'Mafalda Sousa', 1650.00, 923456789, 'mafalda.sousa@PetroManager.com', 007),
(033, 'Rui Almeida', 1600.00, 934567890, 'rui.almeida@PetroManager.com', 007),
(034, 'Sandra Martins', 1550.00, 945678901, 'sandra.martins@PetroManager.com', 007),
(035, 'Antonio Oliveira', 1700.00, 956789012, 'antonio.oliveira@PetroManager.com', 007),
(036, 'Liliana Carvalho', 1600.00, 912345678, 'liliana.carvalho@PetroManager.com', 008),
(037, 'Diogo Santos', 1550.00, 923456789, 'diogo.santos@PetroManager.com', 008),
(038, 'Ana Catarina', 1700.00, 934567890, 'ana.catarina@PetroManager.com', 008),
(039, 'Ricardo Pereira', 1600.00, 945678901, 'ricardo.pereira@PetroManager.com', 008),
(040, 'Teresa Ferreira', 1600.00, 956789012, 'teresa.ferreira@PetroManager.com', 008),
(041, 'Filipe Gomes', 1650.00, 912345678, 'filipe.gomes@PetroManager.com', 009),
(042, 'Joana Lopes', 1600.00, 923456789, 'joana.lopes@PetroManager.com', 009),
(043, 'Miguel Silva', 1700.00, 934567890, 'miguel.silva@PetroManager.com', 009),
(044, 'Catarina Matos', 1550.00, 945678901, 'catarina.matos@PetroManager.com', 009),
(045, 'Bernardo Rodrigues', 1600.00, 956789012, 'bernardo.rodrigues@PetroManager.com', 009),
(046, 'Isabel Ferreira', 1600.00, 912345678, 'isabel.ferreira@PetroManager.com', 010),
(047, 'Goncalo Sousa', 1550.00, 923456789, 'goncalo.sousa@PetroManager.com', 010),
(048, 'Margarida Pereira', 1700.00, 934567890, 'margarida.pereira@PetroManager.com', 010),
(049, 'Duarte Alves', 1600.00, 945678901, 'duarte.alves@PetroManager.com', 010),
(050, 'Beatriz Oliveira', 1600.00, 956789012, 'beatriz.oliveira@PetroManager.com', 010),
(051, 'Rafael Martins', 1650.00, 912345678, 'rafael.martins@PetroManager.com', 011),
(052, 'Leonor Santos', 1600.00, 923456789, 'leonor.santos@PetroManager.com', 011),
(053, 'Tomas Pereira', 1700.00, 934567890, 'tomas.pereira@PetroManager.com', 011),
(054, 'Mariana Oliveira', 1550.00, 945678901, 'mariana.oliveira@PetroManager.com', 011),
(055, 'Guilherme Almeida', 1600.00, 956789012, 'guilherme.almeida@PetroManager.com', 011),
(056, 'Francisca Ferreira', 1600.00, 912345678, 'francisca.ferreira@PetroManager.com', 012),
(057, 'Rodrigo Sousa', 1550.00, 923456789, 'rodrigo.sousa@PetroManager.com', 012),
(058, 'Matilde Ribeiro', 1700.00, 934567890, 'matilde.ribeiro@PetroManager.com', 012),
(059, 'Simao Lopes', 1600.00, 945678901, 'simao.lopes@PetroManager.com', 012),
(060, 'Madalena Pereira', 1600.00, 956789012, 'madalena.pereira@PetroManager.com', 012),
(061, 'Henrique Soares', 1650.00, 912345678, 'henrique.soares@PetroManager.com', 013),
(062, 'Patricia Alves', 1600.00, 923456789, 'patricia.alves@PetroManager.com', 013),
(063, 'Eduarda Lopes', 1550.00, 945678901, 'eduarda.lopes@PetroManager.com', 013),
(064, 'Dinis Pereira', 1600.00, 956789012, 'dinis.pereira@PetroManager.com', 013),
(065, 'Tiago Pinto', 1700.00, 934567890, 'tiago.pinto@PetroManager.com', 013),
(066, 'Ines Gomes', 1600.00, 912345678, 'ines.gomes@PetroManager.com', 014),
(067, 'Rui Leal', 1550.00, 923456789, 'rui.leal@PetroManager.com', 014),
(068, 'Leonor Pinto', 1700.00, 934567890, 'leonor.pinto@PetroManager.com', 014),
(069, 'Francisco Almeida', 1600.00, 945678901, 'francisco.almeida@PetroManager.com', 014),
(070, 'Carolina Ferreira', 1600.00, 956789012, 'carolina.ferreira@PetroManager.com', 014),
(071, 'Goncalo Pereira', 1700.00, 934567890, 'goncalo.pereira@PetroManager.com', 015),
(072, 'Afonso Sousa', 1650.00, 912345678, 'afonso.sousa@PetroManager.com', 015),
(073, 'Leticia Oliveira', 1600.00, 923456789, 'leticia.oliveira@PetroManager.com', 015),
(074, 'Margarida Lopes', 1550.00, 945678901, 'margarida.lopes@PetroManager.com', 015),
(075, 'Diogo Alves', 1600.00, 956789012, 'diogo.alves@PetroManager.com', 015),
(076, 'Beatriz Ferreira', 1600.00, 912345678, 'beatriz.ferreira@PetroManager.com', 016),
(077, 'Tomas Sousa', 1550.00, 923456789, 'tomas.sousa@PetroManager.com', 016),
(078, 'Leonor Oliveira', 1500.00, 934567890, 'leonor.oliveira@PetroManager.com', 016),
(079, 'Dinis Pereira', 1600.00, 945678901, 'dinis.pereira@PetroManager.com', 016),
(080, 'Ines Almeida', 1800.00, 956789012, 'ines.almeida@PetroManager.com', 016);

UPDATE PM.Funcionario
SET Email = REPLACE(Email, 'PetroManager.com', 'PM.com');


INSERT INTO PM.Posto (ID, Cidade, Contacto, Hora_Abertura, Hora_Fecho, MgrID) VALUES
(001, 'Lisboa', 213456789, '08:00', '20:00',04),
(002, 'Porto', 223456789, '09:00', '21:00',08),
(003, 'Coimbra', 239876543, '08:30', '19:30',012),
(004, 'Braga', 253456789, '07:00', '22:00', 018),
(005, 'Faro', 289654321, '08:00', '18:00',025),
(006, 'Aveiro', 234567890, '08:00', '19:00',028),
(007, 'Setubal', 265432109, '09:00', '20:00',035),
(008, 'Evora', 266789012, '07:30', '21:30',038),
(009, 'Vila Real', 275432108, '08:00', '19:30', 043),
(010, 'Viana do Castelo', 298765432, '09:00', '20:00', 048),
(011, 'Leiria', 245321678, '07:30', '21:00', 053),
(012, 'Beja', 278956321, '08:30', '19:00', 058),
(013, 'Portimao', 289345678, '09:00', '18:30', 065),
(014, 'Guarda', 256789432, '07:00', '22:00', 068),
(015, 'Viseu', 234512345, '08:00', '19:30', 071),
(016, 'Chaves', 298761234, '09:30', '20:30', 080);


INSERT INTO PM.Combustivel (ID, Nome) VALUES
(1, 'Diesel'),
(2, 'Gasolina'),
(3, 'GPL');

INSERT INTO PM.Deposito (ID, CapacidadeMax, CapacidadeAtual, ID_Posto) VALUES
(0101, 50000, 40000, 001),
(0102, 50000, 40000, 001),
(0103, 50000, 40000, 001),
(0201, 50000, 40000, 002),
(0202, 50000, 40000, 002),
(0203, 50000, 40000, 002),
(0301, 50000, 40000, 003),
(0302, 50000, 40000, 003),
(0303, 50000, 40000, 003),
(0401, 50000, 40000, 004),
(0402, 50000, 40000, 004),
(0403, 50000, 40000, 004),
(0501, 50000, 40000, 005),
(0502, 50000, 40000, 005),
(0503, 50000, 40000, 005),
(0601, 50000, 40000, 006),
(0602, 50000, 40000, 006),
(0603, 50000, 40000, 006),
(0701, 50000, 40000, 007),
(0702, 50000, 40000, 007),
(0703, 50000, 40000, 007),
(0801, 50000, 40000, 008),
(0802, 50000, 40000, 008),
(0803, 50000, 40000, 008),
(0901, 50000, 40000, 009),
(0902, 50000, 40000, 009),
(0903, 50000, 40000, 009),
(1001, 50000, 40000, 010),
(1002, 50000, 40000, 010),
(1003, 50000, 40000, 010),
(1101, 50000, 40000, 011),
(1102, 50000, 40000, 011),
(1103, 50000, 40000, 011),
(1201, 50000, 40000, 012),
(1202, 50000, 40000, 012),
(1203, 50000, 40000, 012),
(1301, 50000, 40000, 013),
(1302, 50000, 40000, 013),
(1303, 50000, 40000, 013),
(1401, 50000, 40000, 014),
(1402, 50000, 40000, 014),
(1403, 50000, 40000, 014),
(1501, 50000, 40000, 015),
(1502, 50000, 40000, 015),
(1503, 50000, 40000, 015),
(1601, 50000, 40000, 016),
(1602, 50000, 40000, 016),
(1603, 50000, 40000, 016);


INSERT INTO PM.Bomba(ID,IDCombustivel,IDDeposito,PostoID) VALUES
(0101,1,0101,001),
(0102,2,0102,001),
(0103,3,0103,001),
(0201,1,0201,002),
(0202,2,0202,002),
(0203,3,0203,002),
(0301,1,0301,003),
(0302,2,0302,003),
(0303,3,0303,003),
(0401,1,0401,004),
(0402,2,0402,004),
(0403,3,0403,004),
(0501,1,0501,005),
(0502,2,0502,005),
(0503,3,0503,005),
(0601,1,0601,006),
(0602,2,0602,006),
(0603,3,0603,006),
(0701,1,0701,007),
(0702,2,0702,007),
(0703,3,0703,007),
(0801,1,0801,008),
(0802,2,0802,008),
(0803,3,0803,008),
(0901,1,0901,009),
(0902,2,0902,009),
(0903,3,0903,009),
(1001,1,1001,010),
(1002,2,1002,010),
(1003,3,1003,010),
(1101,1,1101,011),
(1102,2,1102,011),
(1103,3,1103,011),
(1201,1,1201,012),
(1202,2,1202,012),
(1203,3,1203,012),
(1301,1,1301,013),
(1302,2,1302,013),
(1303,3,1303,013),
(1401,1,1401,014),
(1402,2,1402,014),
(1403,3,1403,014),
(1501,1,1501,015),
(1502,2,1502,015),
(1503,3,1503,015),
(1601,1,1601,016),
(1602,2,1602,016),
(1603,3,1603,016);

INSERT INTO PM.Precario (CombustivelID, Preco, DataInicio, DataFim) VALUES
(1, 1.450, '2024-01-01', '2024-01-07'),
(1, 1.455, '2024-01-08', '2024-01-14'),
(1, 1.460, '2024-01-15', '2024-01-21'),
(1, 1.463, '2024-01-22', '2024-01-28'),
(1, 1.467, '2024-01-29', '2024-02-04'),
(1, 1.470, '2024-02-05', '2024-02-11'),
(1, 1.474, '2024-02-12', '2024-02-18'),
(1, 1.478, '2024-02-19', '2024-02-25'),
(1, 1.482, '2024-02-26', '2024-03-03'),
(1, 1.485, '2024-03-04', '2024-03-10'),
(1, 1.489, '2024-03-11', '2024-03-17'),
(1, 1.493, '2024-03-18', '2024-03-24'),
(1, 1.497, '2024-03-25', '2024-03-31'),
(1, 1.501, '2024-04-01', '2024-04-07'),
(1, 1.505, '2024-04-08', '2024-04-14'),
(1, 1.509, '2024-04-15', '2024-04-21'),
(1, 1.513, '2024-04-22', '2024-04-28'),
(1, 1.517, '2024-04-29', '2024-05-05'),
(1, 1.521, '2024-05-06', '2024-05-12'),
(1, 1.525, '2024-05-13', '2024-05-19'),
(1, 1.528, '2024-05-20', '2024-05-26'),
(2, 1.600, '2024-01-01', '2024-01-07'),
(2, 1.610, '2024-01-08', '2024-01-14'),
(2, 1.615, '2024-01-15', '2024-01-21'),
(2, 1.620, '2024-01-22', '2024-01-28'),
(2, 1.625, '2024-01-29', '2024-02-04'),
(2, 1.630, '2024-02-05', '2024-02-11'),
(2, 1.635, '2024-02-12', '2024-02-18'),
(2, 1.640, '2024-02-19', '2024-02-25'),
(2, 1.645, '2024-02-26', '2024-03-03'),
(2, 1.650, '2024-03-04', '2024-03-10'),
(2, 1.655, '2024-03-11', '2024-03-17'),
(2, 1.660, '2024-03-18', '2024-03-24'),
(2, 1.665, '2024-03-25', '2024-03-31'),
(2, 1.670, '2024-04-01', '2024-04-07'),
(2, 1.675, '2024-04-08', '2024-04-14'),
(2, 1.680, '2024-04-15', '2024-04-21'),
(2, 1.685, '2024-04-22', '2024-04-28'),
(2, 1.690, '2024-04-29', '2024-05-05'),
(2, 1.695, '2024-05-06', '2024-05-12'),
(2, 1.700, '2024-05-13', '2024-05-19'),
(2, 1.705, '2024-05-20', '2024-05-26'),
(3, 0.630, '2024-01-01', '2024-01-07'),
(3, 0.635, '2024-01-08', '2024-01-14'),
(3, 0.640, '2024-01-15', '2024-01-21'),
(3, 0.645, '2024-01-22', '2024-01-28'),
(3, 0.650, '2024-01-29', '2024-02-04'),
(3, 0.655, '2024-02-05', '2024-02-11'),
(3, 0.660, '2024-02-12', '2024-02-18'),
(3, 0.665, '2024-02-19', '2024-02-25'),
(3, 0.670, '2024-02-26', '2024-03-03'),
(3, 0.675, '2024-03-04', '2024-03-10'),
(3, 0.680, '2024-03-11', '2024-03-17'),
(3, 0.685, '2024-03-18', '2024-03-24'),
(3, 0.690, '2024-03-25', '2024-03-31'),
(3, 0.695, '2024-04-01', '2024-04-07'),
(3, 0.700, '2024-04-08', '2024-04-14'),
(3, 0.705, '2024-04-15', '2024-04-21'),
(3, 0.710, '2024-04-22', '2024-04-28'),
(3, 0.715, '2024-04-29', '2024-05-05'),
(3, 0.720, '2024-05-06', '2024-05-12'),
(3, 0.725, '2024-05-13', '2024-05-19'),
(3, 0.730, '2024-05-20', '2024-05-26');


INSERT INTO PM.Cliente (NIF, Nome, Contacto, Idade) VALUES
(123456789, 'João Silva', 912345678, 35),
(987654321, 'Maria Oliveira', 918765432, 28),
(456123789, 'Carlos Santos', 915678234, 42),
(789456123, 'Ana Martins', 913456789, 31),
(321654987, 'Pedro Ferreira', 919876543, 47),
(654987321, 'Rita Costa', 917654321, 22),
(147258369, 'Tiago Pereira', 916547289, 30),
(258369147, 'Sandra Rodrigues', 914785236, 26),
(369147258, 'Paulo Gonçalves', 911234567, 33),
(741852963, 'Carla Sousa', 918273645, 29),
(852369741, 'Miguel Ramos', 912345679, 40),
(963258741, 'Helena Fernandes', 915678235, 27),
(741963852, 'Luís Carvalho', 913456788, 38),
(852741963, 'Isabel Cardoso', 918765431, 24),
(951753486, 'Ricardo Nunes', 916547288, 32),
(357259446, 'Sofia Lopes', 914785235, 25),
(486159753, 'Vitor Almeida', 911234566, 36),
(753486159, 'Patrícia Sousa', 918273644, 31),
(159357486, 'André Dias', 912345680, 39),
(753951486, 'Marta Pinto', 915678236, 23),
(486753159, 'Jorge Mendes', 913456787, 34),
(357486159, 'Susana Silva', 918765430, 28),
(951486753, 'Nuno Correia', 916547287, 41),
(753159486, 'Paula Rocha', 914785234, 29),
(153486157, 'Fábio Costa', 911234565, 37),
(486753951, 'Carolina Santos', 918273643, 30),
(753159951, 'Alexandre Dias', 912345681, 26),
(951486357, 'Liliana Marques', 915678237, 22),
(357159951, 'Bruno Teixeira', 913456786, 35),
(753486357, 'Daniela Sousa', 918765429, 28),
(159753486, 'Fernando Gomes', 916547286, 42),
(482157357, 'Catarina Neves', 914785233, 27),
(753951357, 'Leonor Ribeiro', 911234564, 31),
(159486753, 'Eduardo Lima', 918273642, 33),
(486357159, 'Margarida Costa', 912345682, 29),
(951753159, 'Rodrigo Pereira', 915678238, 24),
(753159357, 'Sílvia Mendes', 913456785, 38),
(159357951, 'Diogo Fernandes', 918765428, 36),
(486951753, 'Beatriz Lopes', 916547285, 25),
(753186951, 'Raquel Sousa', 914785232, 30),
(951486159, 'Francisco Nogueira', 911234563, 27),
(159753951, 'Joana Faria', 918273641, 32),
(486753357, 'Rui Martins', 912345683, 39),
(752951481, 'Teresa Rocha', 915678239, 26),
(159486951, 'Gonçalo Matos', 913456784, 34),
(486159951, 'Inês Costa', 918765427, 30),
(951753357, 'António Ferreira', 916547284, 41),
(123789456, 'Leonardo Pires', 913789456, 34),
(456987123, 'Mariana Lopes', 919123456, 27),
(789123456, 'João Pedro', 917789123, 36),
(321789654, 'Luísa Sousa', 915321789, 29),
(654321789, 'Fernando Marques', 912654321, 40),
(147369258, 'Sara Dias', 914147369, 24),
(258147369, 'Mário Ferreira', 916258147, 38),
(369258147, 'Tânia Gomes', 918369258, 26),
(741258963, 'Henrique Lima', 911741258, 32),
(852963741, 'Lara Figueiredo', 913852963, 30),
(963741852, 'Bruno Santos', 919963741, 35),
(741852369, 'Cátia Costa', 912741852, 28),
(852741369, 'Pedro Pinto', 917852741, 33),
(951357486, 'Filipa Rocha', 914951357, 25),
(357486951, 'Renato Nunes', 916357486, 37),
(486951357, 'Diana Cardoso', 918486951, 31),
(753486951, 'Adriana Ribeiro', 911753486, 27),
(159486357, 'Gilberto Almeida', 913159486, 29),
(357159486, 'Eva Gonçalves', 915357159, 30),
(486159357, 'Tiago Costa', 919486159, 41);



DECLARE @cliente_nif INT;
DECLARE @posto_id INT;
DECLARE @funcionario_id INT;
DECLARE @litros_transacao INT;
DECLARE @data_hora_transacao DATETIME;
DECLARE @id_combustivel INT;
DECLARE @quantia FLOAT;

-- Loop para cada cliente
DECLARE cursor_cliente CURSOR FOR
  SELECT NIF FROM PM.Cliente;

OPEN cursor_cliente;

FETCH NEXT FROM cursor_cliente INTO @cliente_nif;

WHILE @@FETCH_STATUS = 0
BEGIN


  -- Gera ID de combustível aleatório para este cliente
  SET @id_combustivel = CAST(RAND() * 3 + 1 AS INT);


  -- Gera posto aleatório (entre 1 e 16)
  SET @posto_id = FLOOR(RAND() * 16) + 1;


  -- Calcula o intervalo mínimo e máximo de IDs de funcionários
  DECLARE @funcionario_min INT;
  DECLARE @funcionario_max INT;
  SET @funcionario_min = 5 * @posto_id - 4;
  SET @funcionario_max = 5 * @posto_id;


  -- Loop para 3 funcionários
  SET @funcionario_id = @funcionario_min;
  WHILE @funcionario_id <= @funcionario_max
  BEGIN


    -- Gera litros aleatórios (entre 1 e 50)
    SET @litros_transacao = FLOOR(RAND() * 50) + 1;


    -- Gera data/hora aleatória (entre 2024-01-01 e 2024-05-20)
    SET @data_hora_transacao = CONVERT(DATE, DATEADD(day, CAST(RAND() * (DATEDIFF(day, '2024-01-01', '2024-05-20')) AS INT), '2024-01-01'));


    -- Calcula a Quantia
    SET @quantia = (
        SELECT Preco 
        FROM PM.Precario 
        WHERE DataInicio <= @data_hora_transacao 
            AND DataFim >= @data_hora_transacao 
            AND CombustivelID = @id_combustivel
    );


    SET @quantia = @quantia * @litros_transacao;
	SET @quantia = ROUND(@quantia, 2);


    -- Insere registro de transação na tabela
    BEGIN TRY
      INSERT INTO PM.Transacao (
        TransData,
        Litros,
        IDCombustivel,
        Quantia,
        NIFCliente,
        IDFunc
      )
      VALUES (
        @data_hora_transacao,
        @litros_transacao,
        @id_combustivel,
        @quantia,
        @cliente_nif,
        @funcionario_id
      );
    END TRY
    BEGIN CATCH
      PRINT 'Error inserting transaction: ' + ERROR_MESSAGE();
    END CATCH;

    SET @funcionario_id = @funcionario_id + 1; -- Incrementa o ID do funcionário
  END;

  -- Busca o próximo NIF de cliente
  FETCH NEXT FROM cursor_cliente INTO @cliente_nif;
END;

-- Debug statement

CLOSE cursor_cliente;
DEALLOCATE cursor_cliente;